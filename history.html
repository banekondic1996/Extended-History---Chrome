<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Extended History</title>
<link rel="stylesheet" href="history.css"/>
</head>
<body>
<div class="layout">

<!-- ‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav class="sidebar">
  <div class="logo-row">
    <div class="logo-icon">üïê</div>
    <div>
      <div class="logo-text">Extended History</div>
      <div class="logo-sub">v3.0</div>
    </div>
  </div>

  <div class="nav-body">
    <div class="nav-group-label">Browse</div>
    <button class="nav-item active" data-panel="history">
      <span class="ni-icon">üïê</span> History
    </button>
    <button class="nav-item" data-panel="sessions">
      <span class="ni-icon">üìã</span> Sessions
    </button>
    <button class="nav-item" data-panel="devices">
      <span class="ni-icon">üì°</span> Devices
    </button>

    <div class="nav-group-label">Insights</div>
    <button class="nav-item" data-panel="activity">
      <span class="ni-icon">üìä</span> Activity
    </button>
    <button class="nav-item" data-panel="timespent">
      <span class="ni-icon">üïê</span> Time Spent
    </button>

    <div class="nav-group-label">Library</div>
    <button class="nav-item" data-panel="bookmarks">
      <span class="ni-icon">üîñ</span> Bookmarks
    </button>

    <div class="nav-group-label">System</div>
    <button class="nav-item" id="deleteHistoryNavBtn" style="color:var(--danger)">
      <span class="ni-icon">üóë</span> Delete History
    </button>
    <button class="nav-item" data-panel="settings">
      <span class="ni-icon">‚öô</span> Settings
    </button>
    <button class="nav-item" data-panel="about">
      <span class="ni-icon">‚Ñπ</span> About
    </button>
  </div>

  <div class="sidebar-actions">
    <button class="sa-btn active" id="themeLight">‚òÄ Light</button>
    <button class="sa-btn" id="themeDark">üåô Dark</button>
  </div>
</nav>

<!-- ‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="main">

  <!-- HISTORY -->
  <div class="panel active" id="panel-history">
    <div class="topbar">
      <!-- Date pills with arrows -->
      <div class="date-nav-row">
        <button class="nav-arrow" id="dnLeft">‚Äπ</button>
        <div class="date-scroll-wrap" id="dateScrollWrap">
          <div class="date-scroll" id="dateScroll"></div>
        </div>
        <button class="nav-arrow" id="dnRight">‚Ä∫</button>
      </div>

      <!-- Hour pills -->
      <div class="hour-nav-row" id="hourRow"></div>

      <!-- Search + controls -->
      <div class="search-row">
        <div class="search-box">
          <span class="search-box-icon">üîç</span>
          <input type="text" id="searchInput" placeholder="Search history‚Ä¶"/>
          <button class="search-clear-btn" id="searchClearBtn" title="Clear">‚úï</button>
        </div>
        <select class="mode-sel" id="searchMode">
          <option value="all">All fields</option>
          <option value="title">Title</option>
          <option value="url">URL</option>
          <option value="domain">Domain</option>
        </select>
        <input type="date" id="dateFrom"/>
        <span style="color:var(--text3);flex-shrink:0">‚Üí</span>
        <input type="date" id="dateTo"/>
        <button class="tb-btn" id="clearFiltersBtn">All time</button>
        <button class="tb-btn danger" id="deleteResultsBtn">Delete results</button>
      </div>
    </div>

    <div class="sel-bar" id="selBar">
      <span class="sel-count" id="selCount">0 selected</span>
      <div class="sel-actions">
        <button class="sel-action-btn" id="selAllBtn">Select all visible</button>
        <button class="sel-action-btn" id="selNoneBtn">Deselect all</button>
        <button class="sel-action-btn del" id="selDelBtn">Delete selected</button>
      </div>
    </div>

    <div class="list-area" id="listArea"></div>
  </div>

  <!-- SESSIONS -->
  <div class="panel" id="panel-sessions">
    <div class="panel-scroll">
      <div class="panel-heading">Sessions</div>
      <div id="sessionsContent"><div class="state-msg"><span class="state-msg-icon">‚è≥</span>Loading‚Ä¶</div></div>
    </div>
  </div>

  <!-- DEVICES -->
  <div class="panel" id="panel-devices">
    <div class="panel-scroll">
      <div class="panel-heading">Devices</div>
      <div id="devicesContent"><div class="state-msg"><span class="state-msg-icon">üì°</span>Loading‚Ä¶</div></div>
    </div>
  </div>

  <!-- ACTIVITY -->
  <div class="panel" id="panel-activity">
    <div class="panel-scroll">
      <div class="panel-heading">Activity</div>
      <div class="kpi-grid" id="actKpi"></div>

      <div class="chart-card">
        <div class="cc-header"><span class="cc-title">Daily visits ‚Äî 90 days</span></div>
        <div style="position:relative" id="lineWrap">
          <svg class="chart-svg" id="lineSvg" height="160"></svg>
          <div class="chart-tooltip" id="lineTip"></div>
        </div>
        <div id="lineLabels" style="display:flex;margin-top:5px"></div>
      </div>

      <div class="chart-card">
        <div class="cc-header"><span class="cc-title">Daily visits ‚Äî 30 days</span></div>
        <div class="bar30-wrap" id="bar30Wrap"></div>
        <div class="bar30-dates" id="bar30Dates"></div>
      </div>
    </div>
  </div>

  <!-- TIME SPENT -->
  <div class="panel" id="panel-timespent">
    <div class="panel-scroll">
      <div class="panel-heading">Time Spent</div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:8px">
        <div class="time-filter-row" id="timeFilters" style="margin-bottom:0">
          <button class="tf-btn" data-days="1">24 hours</button>
          <button class="tf-btn active" data-days="15">15 days</button>
          <button class="tf-btn" data-days="30">30 days</button>
          <button class="tf-btn" data-days="90">90 days</button>
        </div>
        <button class="tb-btn danger" id="clearTimeBtn" title="Clear all time-spent data (does not affect history)">üóë Clear time data</button>
      </div>

      <div class="chart-card">
        <div class="cc-header"><span class="cc-title">Daily browsing time</span></div>
        <div style="position:relative">
          <svg class="chart-svg" id="timeSvg" height="130"></svg>
          <div class="chart-tooltip" id="timeTip"></div>
        </div>
        <div id="timeLabels" style="display:flex;margin-top:5px"></div>
      </div>

      <div class="chart-card">
        <div class="cc-header"><span class="cc-title">Top sites by time spent</span></div>
        <div class="timespent-grid">
          <div class="hbar-list" id="hbarList"></div>
          <div class="pie-container">
            <svg class="pie-svg" id="pieSvg" width="160" height="160" viewBox="0 0 160 160"></svg>
            <div class="pie-legend" id="pieLegend"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- BOOKMARKS -->
  <div class="panel" id="panel-bookmarks">
    <!-- Toolbar -->
    <div class="bm-toolbar">
      <button class="action-btn" id="exportBmBtn" style="font-size:0.76rem;padding:6px 12px">‚¨á Export</button>
      <button class="action-btn" id="importBmBtn" style="font-size:0.76rem;padding:6px 12px">‚¨Ü Import</button>
      <input type="file" id="importBmFile" accept=".html" style="display:none"/>
      <div class="search-box" style="flex:1;min-width:160px;max-width:320px">
        <span class="search-box-icon">üîç</span>
        <input type="text" id="bmSearch" placeholder="Search bookmarks‚Ä¶"/>
      </div>
    </div>
    <!-- Split pane: tree left, items right -->
    <div class="bm-split">
      <div class="bm-tree-pane" id="bmTreePane"></div>
      <div class="bm-items-pane" id="bookmarksContent">
        <div class="state-msg"><span class="state-msg-icon">üîñ</span>Loading‚Ä¶</div>
      </div>
    </div>
  </div>

  <!-- SETTINGS -->
  <div class="panel" id="panel-settings">
    <div class="panel-scroll">
      <div class="panel-heading">Settings</div>
      <div class="settings-stack">

        <div class="s-card">
          <div class="s-card-title">History Retention</div>
          <div class="s-row">
            <div class="s-row-info">
              <div class="s-row-lbl">Keep history for</div>
              <div class="s-row-desc">Older entries are automatically pruned</div>
            </div>
            <div class="s-ctrl">
              <input type="number" id="retDays" value="3650" min="1" max="999999"/>
              <span class="unit">days</span>
            </div>
          </div>
          <div class="chips" id="retChips">
            <button class="chip" data-d="90">90 days</button>
            <button class="chip" data-d="180">6 months</button>
            <button class="chip" data-d="365">1 year</button>
            <button class="chip" data-d="730">2 years</button>
            <button class="chip" data-d="1825">5 years</button>
            <button class="chip on" data-d="3650">10 years</button>
            <button class="chip" data-d="36500">Forever</button>
          </div>
        </div>

        <div class="s-card">
          <div class="s-card-title">Appearance</div>
          <div class="s-row">
            <div class="s-row-info">
              <div class="s-row-lbl">Font family</div>
            </div>
            <div class="s-ctrl">
              <select id="fontSel">
                <option value="system-ui">System default</option>
                <option value="-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif">Apple / Segoe UI</option>
                <option value="Georgia, 'Times New Roman', serif">Georgia (serif)</option>
                <option value="'Courier New', Courier, monospace">Courier New (mono)</option>
                <option value="Verdana, Geneva, sans-serif">Verdana</option>
                <option value="Tahoma, Geneva, sans-serif">Tahoma</option>
                <option value="'Trebuchet MS', Helvetica, sans-serif">Trebuchet MS</option>
              </select>
            </div>
          </div>
          <div class="s-row">
            <div class="s-row-info">
              <div class="s-row-lbl">Font size</div>
              <div class="s-row-desc">Base UI text size</div>
            </div>
            <div class="s-ctrl">
              <input type="number" id="fontSzInput" value="15" min="11" max="22" style="width:70px"/>
              <span class="unit">px</span>
            </div>
          </div>
          <div class="s-row" style="border-bottom:none;flex-direction:column;align-items:flex-start;gap:12px">
            <div class="s-row-lbl">Accent colors</div>
            <div class="color-grid" style="width:100%;padding:0">
              <div class="color-block">
                <div class="color-lbl">Primary</div>
                <div class="color-row">
                  <div class="color-swatch" id="sw1" style="background:#3b9eff"></div>
                  <input type="color" id="cp1" value="#3b9eff"/>
                  <span class="color-hex" id="ch1">#3b9eff</span>
                </div>
                <div class="color-swatches" id="cps1">
                  <div class="cs on" data-c="#3b9eff" style="background:#3b9eff"></div>
                  <div class="cs" data-c="#a855f7" style="background:#a855f7"></div>
                  <div class="cs" data-c="#f97316" style="background:#f97316"></div>
                  <div class="cs" data-c="#ec4899" style="background:#ec4899"></div>
                  <div class="cs" data-c="#eab308" style="background:#eab308"></div>
                  <div class="cs" data-c="#ef4444" style="background:#ef4444"></div>
                  <div class="cs" data-c="#c8a96e" style="background:#c8a96e"></div>
                </div>
              </div>
              <div class="color-block">
                <div class="color-lbl">Secondary</div>
                <div class="color-row">
                  <div class="color-swatch" id="sw2" style="background:#2dd4a0"></div>
                  <input type="color" id="cp2" value="#2dd4a0"/>
                  <span class="color-hex" id="ch2">#2dd4a0</span>
                </div>
                <div class="color-swatches" id="cps2">
                  <div class="cs on" data-c="#2dd4a0" style="background:#2dd4a0"></div>
                  <div class="cs" data-c="#34d399" style="background:#34d399"></div>
                  <div class="cs" data-c="#60a5fa" style="background:#60a5fa"></div>
                  <div class="cs" data-c="#f472b6" style="background:#f472b6"></div>
                  <div class="cs" data-c="#facc15" style="background:#facc15"></div>
                  <div class="cs" data-c="#9b7ebd" style="background:#9b7ebd"></div>
                  <div class="cs" data-c="#fb923c" style="background:#fb923c"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="s-card">
          <div class="s-card-title">Data</div>
          <div class="s-row">
            <div class="s-row-info">
              <div class="s-row-lbl">Export history</div>
              <div class="s-row-desc">Full JSON backup of all history + time data</div>
            </div>
            <div class="s-ctrl">
              <button class="action-btn" id="exportDataBtn">‚¨á Export JSON</button>
            </div>
          </div>
          <div class="s-row" style="border-top:1px solid var(--border)">
            <div class="s-row-info">
              <div class="s-row-lbl">Import history</div>
              <div class="s-row-desc">Merge entries from a previously exported JSON file</div>
            </div>
            <div class="s-ctrl">
              <button class="action-btn" id="importDataBtn">‚¨Ü Import JSON</button>
              <input type="file" id="importDataFile" accept=".json" style="display:none"/>
            </div>
          </div>
        </div>

        <button class="action-btn primary" id="saveSettingsBtn" style="align-self:flex-start">Save Settings</button>

        <div class="s-card" style="border-color: color-mix(in srgb, var(--danger) 30%, transparent); background: color-mix(in srgb, var(--danger) 4%, transparent)">
          <div class="s-card-title" style="color:var(--danger)">Danger Zone</div>
          <div class="s-row">
            <div class="s-row-info">
              <div class="s-row-lbl">Re-import Chrome history</div>
              <div class="s-row-desc">Pull all available Chrome native history again (merges, no duplicates)</div>
            </div>
            <div class="s-ctrl">
              <button class="action-btn" id="reBackfillBtn">‚Ü∫ Re-import</button>
            </div>
          </div>
          <div class="s-row" style="border-top:1px solid color-mix(in srgb,var(--danger) 20%,transparent);border-bottom:none">
            <div class="s-row-info">
              <div class="s-row-lbl">Clear all history</div>
              <div class="s-row-desc">Permanently deletes all stored history. Cannot be undone.</div>
            </div>
            <div class="s-ctrl">
              <button class="action-btn danger" id="clearAllBtn">üóë Clear All</button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- ABOUT -->
  <div class="panel" id="panel-about">
    <div class="panel-scroll">
      <div class="panel-heading">About</div>
      <div style="max-width:560px;padding:8px 0 32px">
        <div style="font-size:2.8rem;margin-bottom:16px">üïê</div>
        <div style="font-size:1.35rem;font-weight:700;color:var(--text);margin-bottom:8px">Extended History</div>
        <div style="font-size:0.92rem;color:var(--text2);line-height:1.7;margin-bottom:24px">
          Created by <strong style="color:var(--text)">Bane Kondiƒá</strong>, cause Google doesn't want you to have more than 90 days of history in the browser.
        </div>
        <a href="https://github.com/banekondic1996/" target="_blank"
           style="display:inline-flex;align-items:center;gap:10px;padding:12px 20px;background:var(--surf2);border:1.5px solid var(--border2);border-radius:10px;color:var(--text);text-decoration:none;font-size:0.9rem;font-weight:500;transition:all 0.15s">
          <span style="font-size:1.2rem">‚å•</span>
          github.com/banekondic1996
        </a>
      </div>
    </div>
  </div>

</div><!-- /main -->
</div><!-- /layout -->

<div class="toast" id="toast"></div>

<!-- Context menu -->
<div id="ctxMenu" style="display:none;position:fixed;z-index:9999;background:var(--surf2);border:1px solid var(--border2);border-radius:8px;padding:4px;min-width:200px;box-shadow:0 8px 28px var(--shadow);font-size:0.85rem;">
  <div class="ctx-item" id="ctx-open-tab">‚Üó Open in new tab</div>
  <div class="ctx-item" id="ctx-open-incognito">üïµ Open in incognito</div>
  <div class="ctx-sep"></div>
  <div class="ctx-item" id="ctx-copy-url">‚éò Copy URL</div>
  <div class="ctx-item" id="ctx-copy-title">üìã Copy title</div>
  <div class="ctx-sep" id="ctx-del-sep"></div>
  <div class="ctx-item danger" id="ctx-delete">‚úï Delete from history</div>
</div>


<script src="history.js"></script>

<!-- Delete History Modal -->
<div class="modal-backdrop" id="deleteHistoryModal">
  <div class="modal-box">
    <div class="modal-title">üóë Delete History</div>
    <div class="modal-sub">Choose a time range to delete. This will remove entries from both this extension and Chrome's native history.</div>
    <div class="dh-range-grid" id="dhRangeGrid">
      <button class="dh-range-btn" data-range="1h">Last 1 hour</button>
      <button class="dh-range-btn" data-range="24h">Last 24 hours</button>
      <button class="dh-range-btn" data-range="7d">Last 7 days</button>
      <button class="dh-range-btn" data-range="30d">Last 30 days (month)</button>
      <button class="dh-range-btn" data-range="5mo">Last 5 months</button>
      <button class="dh-range-btn" data-range="all">All time</button>
    </div>
    <div class="dh-options">
      <label class="dh-option"><input type="checkbox" id="dhCookies"/> Clear cookies &amp; local storage</label>
      <label class="dh-option"><input type="checkbox" id="dhCache"/> Clear cache</label>
    </div>
    <div id="dhConfirmWarn" style="display:none;background:color-mix(in srgb,var(--danger) 10%,transparent);border:1px solid color-mix(in srgb,var(--danger) 30%,transparent);border-radius:8px;padding:9px 13px;font-size:0.8rem;color:var(--danger);margin-bottom:14px;line-height:1.5"></div>
    <div class="dh-actions">
      <button class="dh-cancel" id="dhCancelBtn">Cancel</button>
      <button class="dh-confirm" id="dhConfirmBtn" disabled>Delete</button>
    </div>
  </div>
</div>
</body>
</html>
